<!Document html>
<html><head></head><body>/////////////////////////////////////////////////////////////////////<br />// DirExplorerE.cpp - directory explorer using events              //<br />// ver 1.0                                                         //<br />// Jim Fawcett, CSE687 - Object Oriented Design, Fall 2018         //<br />/////////////////////////////////////////////////////////////////////<br />/*<br />*  Note:<br />*  This file simulates application code that uses DirExplorerE.<br />*/<br /><br />#ifdef TEST_DIREXPLORERE  // only compile the following when defined<br /><br />#include "DirExplorerE.h"<br />#include "../Utilities/StringUtilities/StringUtilities.h"<br />#include "../Utilities/CodeUtilities/CodeUtilities.h"<br /><br />using namespace Utilities;<br />using namespace FileSystem;<br /><br />/////////////////////////////////////////////////////////////////////<br />// dirEventHandler class defines dir processing without modifying<br />// DirExplorerE code.<br /><br />class dirEventHandler : public IDirEvent<br />{<br />public:<br />  void execute(const std::string& dirname)<br />  {<br />    std::cout &lt;<br />  }<br />};<br /><br />/////////////////////////////////////////////////////////////////////<br />// fileEventHandler class defines file processing without modifying<br />// DirExplorerE code.<br /><br />class fileEventHandler : public IFileEvent<br />{<br />public:<br />  void execute(const std::string& filename)<br />  {<br />    std::cout &lt;<br />  }<br />};<br /><br />class AppDirExplorerE : public DirExplorerE<br />{<br />public:<br />  AppDirExplorerE(const std::string& path) : DirExplorerE(path) {}<br /><br />  virtual bool done(bool reset = false)<br />  {<br />    static bool first = true;<br />  <br />    if (first || reset)<br />    {<br />      std::cout &lt;<br />      first = false;<br />    }<br />    return DirExplorerE::done();<br />  }<br />};<br /><br />ProcessCmdLine::Usage customUsage()<br />{<br />  std::string usage;<br />  usage += "\n  Command Line: path [/option]* [/pattern]*";<br />  usage += "\n    path is relative or absolute path where processing begins";<br />  usage += "\n    [/option]* are one or more options of the form:";<br />  usage += "\n      /s - walk directory recursively";<br />  usage += "\n      /h - hide empty directories";<br />  usage += "\n      /a - on stopping, show all files in current directory";<br />  usage += "\n    [pattern]* are one or more pattern strings of the form:";<br />  usage += "\n      *.h *.cpp *.cs *.txt or *.*";<br />  usage += "\n";<br />  return usage;<br />}<br /><br />int main(int argc, char *argv[])<br />{<br />  Title("Demonstrate DirExplorer-Events, " + DirExplorerE::version());<br /><br />  ProcessCmdLine pcl(argc, argv);<br />  pcl.usage(customUsage());<br /><br />  preface("Command Line: ");<br />  pcl.showCmdLine();<br />  putline();<br /><br />  if (pcl.parseError())<br />  {<br />    pcl.usage();<br />    std::cout &lt;<br />    return 1;<br />  }<br /><br />  AppDirExplorerE de(pcl.path());<br /><br />  //----&lt;<br /><br />  de.dirSubScribe(new dirEventHandler);<br />  de.fileSubScribe(new fileEventHandler);<br /><br />  for (auto patt : pcl.patterns())<br />  {<br />    de.addPattern(patt);<br />  }<br /><br />  if (pcl.hasOption('s'))<br />  {<br />    de.recurse();<br />  }<br /><br />  if (pcl.hasOption('a'))<br />  {<br />    de.showAllInCurrDir(true);<br />  }<br /><br />  if (pcl.hasOption('h'))<br />  {<br />    de.hideEmptyDirectories(true);<br />  }<br /><br />  if (pcl.maxItems() &gt;<br />  {<br />    de.maxItems(pcl.maxItems());<br />  }<br /><br />  //----&lt;<br /><br />  de.search();<br />  de.showStats();<br /><br />  std::cout &lt;<br />  return 0;<br />}<br /><br />#endif<br /></body>/html