<!Document html>
<html><head></head><body>#pragma once<br />///////////////////////////////////////////////////////////////////////<br />// TestUtilities.h - provides single-user test harness               //<br />// ver 1.0                                                           //<br />// Language:    C++, Visual Studio 2017                              //<br />// Application: Most Projects, CSE687 - Object Oriented Design       //<br />// Author:      Jim Fawcett, Syracuse University, CST 4-187          //<br />//              jfawcett@twcny.rr.com                                //<br />///////////////////////////////////////////////////////////////////////<br />/*<br />* Package Operations:<br />* -------------------<br />* This package provides classes:<br />* - TestExecutor    Executes single test in the context of a try-catch block<br />* - TestExecutive   Uses TestExecutor to run a sequence of tests<br />*<br />* Required Files:<br />* ---------------<br />*   TestUtilities.h<br />*<br />* Maintenance History:<br />* --------------------<br />* ver 1.0 : 12 Jan 2018<br />* - first release<br />* - refactored from earlier Utilities.h<br />*<br />* Notes:<br />* ------<br />* - Designed to provide all functionality in header file.<br />* - Implementation file only needed for test and demo.<br />*<br />* Planned Additions and Changes:<br />* ------------------------------<br />* - none yet<br />*/<br /><br />#include &lt;<br />#include &lt;<br /><br />/////////////////////////////////////////////////////////////////////<br />// TestExecutor class<br />// - supports execution of callable objects for testing in the<br />//   context of a try-catch block.<br /><br />template&lt;<br />class TestExecutor<br />{<br />public:<br />  bool execute(T t, const std::string& name, std::ostream& out = std::cout);<br />private:<br />  void check(bool result, std::ostream& out);<br />};<br />//----&lt;<br /><br />template &lt;<br />bool TestExecutor&lt;<br />{<br />  bool result = false;<br />  try<br />  {<br />    result = t();<br />    check(result, out);<br />    out &lt;<br />  }<br />  catch (std::exception& ex)<br />  {<br />    check(false, out);<br />    out &lt;<br />    out &lt;<br />  }<br />  return result;<br />}<br />//----&lt;<br /><br />template&lt;<br />void TestExecutor&lt;<br />{<br />  if (result)<br />    out &lt;<br />  else<br />    out &lt;<br />}<br /><br />///////////////////////////////////////////////////////////////////////<br />// TestExecutive class<br />// - executes a sequence of tests with the help of TestExecutor<br /><br />class TestExecutive<br />{<br />public:<br />  using Test = std::function&lt;<br />  using TestItem = struct {<br />    Test test;<br />    std::string testName;<br />  };<br />  using Tests = std::vector&lt;<br /><br />  bool doTests();<br />  void registerTest(Test t, const std::string& testName);<br />  void registerTest(TestItem ts);<br />private:<br />  Tests tests_;<br />};<br /><br />inline void TestExecutive::registerTest(Test t, const std::string& testName)<br />{<br />  TestItem ts{ t, testName };<br />  tests_.push_back(ts);<br />}<br /><br />inline void TestExecutive::registerTest(TestItem ts)<br />{<br />  tests_.push_back(ts);<br />}<br /><br />inline bool TestExecutive::doTests()<br />{<br />  TestExecutor&lt;<br />  bool result = true;<br />  for (auto item : tests_)<br />  {<br />    bool tResult = tester.execute(item.test, item.testName);<br />    if (tResult == false)<br />      result = false;<br />  }<br />  return result;<br />}<br /><br /><br /></body>/html